(function(t){function e(e){for(var a,o,i=e[0],c=e[1],l=e[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(a=!1)}a&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},r={app:0},s=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[t.loading?n("v-container",[n("v-row",[n("v-col",{staticClass:"text-center"},[n("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})],1)],1)],1):t.loggedUser&&!t.loading?n("Chat",{attrs:{"logged-user":t.loggedUser}}):n("Login",{on:{"auth-success":t.fetchUser}})],1)},s=[],o=(n("d3b7"),n("96cf"),n("1da1")),i=(n("99af"),n("d4ec")),c=n("bee2"),l=n("bc3a"),u=n.n(l),d=function(){function t(){Object(i["a"])(this,t),u.a.interceptors.request.use((function(t){var e=localStorage.getItem("_token");return t.headers["Content-type"]="application/json",t.headers["x-access-token"]=e,t}),(function(t){return Promise.reject(t.response)}))}return Object(c["a"])(t,[{key:"query",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.a.get(t,e).catch((function(t){throw new Error("ApiService ".concat(t))}))}},{key:"get",value:function(t,e){return u.a.get("".concat(t,"/").concat(e)).catch((function(t){throw new Error("ApiService ".concat(t))}))}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u.a.post(t,e,n)}},{key:"put",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u.a.put(t,e,n)}},{key:"delete",value:function(t){return u.a.delete(t).catch((function(t){throw new Error("ApiService ".concat(t))}))}}]),t}(),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-navigation-drawer",{attrs:{app:"",permanent:""},scopedSlots:t._u([t.loggedUser?{key:"prepend",fn:function(){return[n("v-list-item",{attrs:{"two-line":""}},[n("v-list-item-avatar",{staticClass:"justify-center",attrs:{color:"primary"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t.initials(t.loggedUser.name)))])]),n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.loggedUser.name))]),n("v-list-item-subtitle",[t._v("Logged In")])],1)],1)]},proxy:!0}:null],null,!0)},[n("v-divider"),n("v-list",{attrs:{subheader:""}},[n("v-subheader",[t._v("Users")]),t._l(t.users,(function(e){return n("v-list-item",{key:e.id},[n("v-list-item-avatar",{staticClass:"justify-center",attrs:{color:e.online?"primary accent-4":"grey"}},[n("span",{staticClass:"white--text"},[t._v(" "+t._s(t.initials(e.name))+" ")])]),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e.name)}})],1),n("v-list-item-icon",[n("v-btn",{attrs:{icon:"",color:"primary accent-4"},on:{click:function(n){return t.startChat(e)}}},[n("v-icon",[t._v("mdi-message-outline")])],1)],1)],1)}))],2),n("v-divider")],1),n("v-main",[t.context?n("ChatMessages",{attrs:{"logged-user":t.loggedUser,messages:t.messages,socket:t.socket,context:t.context}}):t._e()],1)],1)},v=[],f=(n("a15b"),n("d81d"),n("ac1f"),n("1276"),n("8e27")),m=n.n(f),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"d-flex flex-column-reverse",staticStyle:{height:"100%"}},[n("v-form",{on:{submit:function(e){return e.preventDefault(),t.sendMessage(e)}}},[n("div",{staticClass:"d-flex align-baseline"},[n("v-text-field",{attrs:{label:"Just f-ing say it, do it!","hide-details":"auto"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),n("v-btn",{staticClass:"ml-5",attrs:{type:"submit",color:"primary"}},[t._v("Send")])],1)]),n("v-row",[n("v-col",{staticClass:"d-inline-flex flex-column-reverse"},[t._l(t.messages,(function(e){var a=e.id,r=e.user_id,s=e.sent_at,o=e.message;return[r===t.loggedUser.id?n("v-row",{key:a,staticClass:"flex-grow-0"},[n("v-col",{staticClass:"text-left"}),n("v-col",{staticClass:"text-right"},[n("v-card",{attrs:{elevation:"0"}},[n("v-card-text",{staticClass:"py-0"},[n("div",{staticClass:"text--primary"},[n("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[n("v-chip",t._g(t._b({staticStyle:{"margin-top":"2px"},attrs:{color:"primary"}},"v-chip",r,!1),a),[t._v(t._s(o))])]}}],null,!0)},[n("span",[t._v(t._s(new Date(s).toLocaleTimeString("cs")))])])],1)])],1)],1)],1):n("v-row",{key:a,staticClass:"flex-grow-0"},[n("v-col",{staticClass:"text-left"},[n("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[n("v-chip",t._g(t._b({staticStyle:{"margin-top":"2px"}},"v-chip",r,!1),a),[t._v(t._s(o))])]}}],null,!0)},[n("span",[t._v(t._s(new Date(s).toLocaleTimeString("cs")))])])],1),n("v-col",{staticClass:"text-right"})],1)]}))],2)],1)],1)},h=[],x={name:"ChatMessages",props:["messages","loggedUser","socket","context"],data:function(){return{text:""}},methods:{sendMessage:function(){this.text&&(this.socket.emit("message",{context:this.context,text:this.text,userId:this.loggedUser.id}),this.text="")}}},b=x,y=n("2877"),w=n("6544"),_=n.n(w),k=n("8336"),V=n("b0af"),C=n("99d9"),j=n("cc20"),S=n("62ad"),O=n("a523"),U=n("4bd4"),L=n("0fd9"),T=n("8654"),R=n("3a2f"),I=Object(y["a"])(b,g,h,!1,null,"01262f84",null),A=I.exports;_()(I,{VBtn:k["a"],VCard:V["a"],VCardText:C["b"],VChip:j["a"],VCol:S["a"],VContainer:O["a"],VForm:U["a"],VRow:L["a"],VTextField:T["a"],VTooltip:R["a"]});var M=new d,P={name:"Chat",components:{ChatMessages:A},props:["loggedUser"],data:function(){return{users:[],messages:[],context:null,socket:null}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.socket=m()(),t.socket.emit("joined",t.loggedUser),e.next=4,M.query("users").then((function(e){t.users=e.data}));case 4:t.socket.on("users",(function(e){t.users=e})),t.socket.on("message",(function(e){t.messages.unshift(e)}));case 6:case"end":return e.stop()}}),e)})))()},methods:{sendMessage:function(){this.socket.emit("message",{context:this.context,text:this.text})},initials:function(t){return t.split(" ").map((function(t){return t.charAt(0)})).join("")},startChat:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,M.get("chat",t.id).then((function(t){var n=t.data,a=n.id,r=n.messages;e.messages=r,e.context={type:"chat",id:a},e.socket.emit("join_chat","chat:"+a),setTimeout((function(){window.scrollTo(0,document.querySelector(".v-main").scrollHeight)}),200)}));case 2:case"end":return n.stop()}}),n)})))()}}},E=P,$=n("7496"),q=n("ce7e"),D=n("132d"),F=n("8860"),B=n("da13"),J=n("8270"),z=n("5d23"),Z=n("34c3"),H=n("f6c4"),N=n("f774"),W=n("e0c7"),G=Object(y["a"])(E,p,v,!1,null,"421c0d17",null),K=G.exports;_()(G,{VApp:$["a"],VBtn:k["a"],VDivider:q["a"],VIcon:D["a"],VList:F["a"],VListItem:B["a"],VListItemAvatar:J["a"],VListItemContent:z["a"],VListItemIcon:Z["a"],VListItemSubtitle:z["b"],VListItemTitle:z["c"],VMain:H["a"],VNavigationDrawer:N["a"],VSubheader:W["a"]});var Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"inspire"}},[n("v-main",[n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-col",{attrs:{sm:"8",md:"6",lg:"4",xl:"3"}},[n("v-form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{dark:"",color:"primary"}},[n("v-toolbar-title",[t._v("Welcome to Chattie")])],1),n("v-card-text",[n("v-text-field",{attrs:{"prepend-icon":"mdi-account",name:"login",label:"Email",type:"text",rules:[function(t){return!!t||"Required."},t.emailRule]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),n("v-text-field",{attrs:{id:"password","prepend-icon":"mdi-lock",name:"password",label:"Password",type:"password",rules:[function(t){return!!t||"Required."}]},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{type:"submit",loading:t.loading,color:"primary"}},[t._v("Login")])],1)],1)],1)],1)],1)],1)],1),n("v-snackbar",{attrs:{color:t.color,top:""},scopedSlots:t._u([{key:"action",fn:function(e){var a=e.attrs;return[n("v-btn",t._b({attrs:{color:"white",text:""},on:{click:function(e){t.snackbar=!1}}},"v-btn",a,!1),[t._v(" Close ")])]}}]),model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.text)+" ")])],1)},X=[],Y={name:"Login",data:function(){return{email:"",password:"",loading:!1,snackbar:!1,color:"success",text:"",emailRule:function(t){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)||"Invalid e-mail."}}},methods:{login:function(){var t=this;this.loading=!0,u.a.post("/users/login",{email:this.email,password:this.password}).then((function(e){localStorage.setItem("_token",e.data.token),t.$emit("auth-success")})).catch((function(e){t.color="primary",t.text=e.response.data.error,t.snackbar=!0})).finally((function(){t.loading=!1}))}}},tt=Y,et=n("a722"),nt=n("2db4"),at=n("2fa4"),rt=n("71d9"),st=n("2a7f"),ot=Object(y["a"])(tt,Q,X,!1,null,"5e159739",null),it=ot.exports;_()(ot,{VApp:$["a"],VBtn:k["a"],VCard:V["a"],VCardActions:C["a"],VCardText:C["b"],VCol:S["a"],VContainer:O["a"],VForm:U["a"],VLayout:et["a"],VMain:H["a"],VSnackbar:nt["a"],VSpacer:at["a"],VTextField:T["a"],VToolbar:rt["a"],VToolbarTitle:st["a"]});var ct=new d,lt={name:"App",components:{Login:it,Chat:K},data:function(){return{loggedUser:null,loading:!0}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchUser();case 2:case"end":return e.stop()}}),e)})))()},methods:{fetchUser:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ct.get("users","logged").then((function(e){t.loggedUser=e.data})).finally((function(){t.loading=!1}));case 2:case"end":return e.stop()}}),e)})))()}}},ut=lt,dt=n("8e36"),pt=Object(y["a"])(ut,r,s,!1,null,null,null),vt=pt.exports;_()(pt,{VApp:$["a"],VCol:S["a"],VContainer:O["a"],VProgressLinear:dt["a"],VRow:L["a"]});var ft=n("f309");a["a"].use(ft["a"]);var mt=new ft["a"]({});a["a"].config.productionTip=!1,new a["a"]({vuetify:mt,render:function(t){return t(vt)}}).$mount("#app")}});
//# sourceMappingURL=app.26010d3e.js.map